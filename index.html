<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" item-width="50%" item-height="auto">
    <title>Space AG | Control</title>
    <link href="./css/control.css" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.2/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <link href="http://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./Gauge/css/cmGauge.css">
    
    <style>
    body { margin:0; padding:0; }
    #map { width:100%; height: 850px; }

    #dot {
      height: 10px;
      width: 10px;
      background-color: #dfdfdf;
      border-radius: 50%;
      display: inline;
      margin-bottom: 10px;
    }

    #dot span#connected-label {
      display: none;
    }

    #dot span#not-connected-label {
      display: inline;
    }

    #dot.connected {
      background-color: #69af22;
    }

    span#dot span {
        position: relative;
        left: 15px;
        top: -2px;
        width: 100%;
    }

    #dot.connected span#connected-label {
      display: inline;
    }

    #dot.connected span#not-connected-label {
      display: none;
    }

    li.nav-item {
        margin-left: 17px;
    }
    span#dropdownMenuButton{
        float: right;
    }
    .variables-value{
        background: #FFF;
        padding: 2% 5%;
        margin: 6px;
        border-right: 1px solid #dfdfdf;
    }
    .value-dato{
        text-align: center;
        color: #69af22;
        font-weight: bold;
        font-size: 30px;
    }
    a.dropdown-item{
      color: #717171;
    }
    h6.text-center{
      color: #707070;
      font-weight: normal;
      font-size: 14px;
    }
    
    .contenedor-datos.row{
      margin-top: 25px;
    }

    /*charts js*/
    a.canvasjs-chart-credit{
      display: none;
    }
    </style>

  </head>

  <body>
    <nav class="navbar  fixed-top flex-md-nowrap p-0 shadow">
      <a href="#" class="col-sm-3 col-md-5 col-lg-5"><img class="navbar-brand"  width="160px" src="./img/spaceag.png" alt=""></a>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <main role="main" class="col-lg-6 col-md-12 ml-sm-auto">
          <div id='map'>
          </div>
        </main>
        <nav class="col-lg-6 d-md-block sidebar">
            <div class="sidebar-sticky">
              <h6 id="connected-bar" class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                <span id="dot">
                  <span id="connected-label">
                    Conectado
                  </span> 
                  <span id="not-connected-label">
                    No Conectado
                  </span> 
                </span> 
              </h6>
              <div class="contenedor-datos row">
                  <div class="col-12">DATOS DEL TRACTOR</div>
                     <div class="col variables-value">
                         <div class="dropdown">
                                 Temperature
                                 <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                 </span>
                                 <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                   <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                 </div>
                         </div>
                         <div class="nav-item">
                             <h6 class="text-center">Last value Temperature:</h6>
                             <div class="temperature value-dato" id="temperature">100.00
                             </div>
                         </div>
                     </div>
                     <div class="col variables-value">
                         <div class="dropdown">
                                 Humidity
                                 <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                 </span>
                                 <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                   <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                 </div>
                         </div>
                         <div class="nav-item">
                             <h6 class="text-center">Last value Humidity:</h6>
                             <div class="humidity value-dato" id="humidity">20.00
                             </div>
                         </div>
                     </div>
                     <div class="col variables-value">
                         <div class="dropdown">
                                 Light(lux)
                                 <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                 </span>
                                 <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                   <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                   <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                 </div>
                         </div>
                         <div class="nav-item">
                             <h6 class="text-center">Last value Light(lux):</h6>
                             <div class="light value-dato" id="light">61.25
                             </div>
                         </div>
                     </div>
                    
               </div>
               <div class="contenedor-datos row">
                 <div class="col-12">
                   <div id="level-components">
                    <div id="chartContainer" style="height: 300px; width: 100%;"></div>
                    </div>
                 </div>
               </div>
              <div class="contenedor-datos row">
               <div class="col-12">DATOS DEL TRACTOR</div>
                  <div class="col-4 variables-value">
                      <div class="dropdown">
                              Temperature
                              <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              </span>
                              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                              </div>
                      </div>
                      <div class="nav-item">
                          <div class="humidity value-dato" id="humidity">100.00
                          </div>
                      </div>
                  </div>
                  <div class="col-7 variables-value">
                      <h6 class="text-center">Last value Speed:</h6>
                      <div class="speed gauge" id="speed">
                        <div class="gauge-arrow" data-percentage="100"
                                    style="transform: rotate(0deg);">
                        </div>
                      </div>
                  </div>
                  <div class="col-4 variables-value">
                      <div class="dropdown">
                              Humidity
                              <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              </span>
                              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                              </div>
                      </div>
                      <div class="nav-item">
                          <div class="humidity value-dato" id="humidity">20.00
                          </div>
                      </div>
                  </div>
                  <div class="col-7 variables-value">
                      <h6 class="text-center">Last value Speed:</h6>
                      <div class="speed gauge" id="speed">
                        <div class="gauge-arrow" data-percentage="100"
                                    style="transform: rotate(0deg);">
                        </div>
                      </div>
                  </div>
                  <div class="col-4 variables-value">
                      <div class="dropdown">
                              Light(lux)
                              <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              </span>
                              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                              </div>
                      </div>
                      <div class="nav-item">
                          <div class="humidity value-dato" id="humidity">61.25
                          </div>
                      </div>
                  </div>
                  <div class="col-7 variables-value">
                      <h6 class="text-center">Last value Speed:</h6>
                      <div class="speed gauge" id="speed">
                        <div class="gauge-arrow" data-percentage="100"
                                    style="transform: rotate(0deg);">
                        </div>
                      </div>
                  </div>
                 
            </div>
              <div class="contenedor-datos row">
               
                    <div class="col variables-value">
                        <div class="dropdown">
                                Tank-level
                                <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                </span>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                  <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                  <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                  <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                  <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                </div>
                        </div>
                        <div class="nav-item">
                                <h6 class="text-center">Last value Speed:</h6>
                                <div class="speed gauge" id="speed">
                                  <div class="gauge-arrow" data-percentage="100"
                                              style="transform: rotate(0deg);">
                                  </div>
                                </div>
                        </div>
                    </div>
                    <div class="col variables-value">
                            <div class="dropdown">
                                    Tank-level
                                    <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    </span>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                      <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                      <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                      <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                      <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                    </div>
                            </div>
                            <div class="nav-item">
                                    <h6 class="text-center">Last value Tank-level:</h6>
                                    <div class="tank-level" id="tank-level">
                                        
                                    </div>
                            </div>
                    </div>
                    <div class="col variables-value">
                            <div class="dropdown">
                                    Battery-level
                                    <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    </span>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                      <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                      <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                      <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                      <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                    </div>
                            </div>
                            <div class="nav-item">
                                    <h6 class="text-center">Last value Tank-level:</h6>
                                    <div class="battery-level" id="battery-level">
                                        
                                    </div>
                            </div>
                    </div>
              </div>
              <div class="contenedor-datos row">
                  <div class="col-lg-12">
                      <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                          <span>Datos Atmosféricos</span>
                      </h6>
                 </div>
                      <div class="col variables-value">
                          <div class="dropdown">
                                  Humidity
                                  <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                  </span>
                                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                    <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                    <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                    <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                  </div>
                          </div>
                          <div class="nav-item">
                                  <h6 class="text-center">Last value Humidity:</h6>
                                  <div class="humidity value-dato" id="humidity">50.61
                                  </div>
                          </div>
                      </div>
                      <div class="col variables-value">
                              <div class="dropdown">
                                      Temperature
                                      <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                      </span>
                                      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                        <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                        <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                        <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                      </div>
                              </div>
                              <div class="nav-item">
                                      <h6 class="text-center">Last value Temperature:</h6>
                                      <div class="temperature value-dato" id="temperature">
                                          28.69
                                      </div>
                              </div>
                      </div>
                      <div class="col variables-value">
                              <div class="dropdown">
                                      Pressure
                                      <span class="dropdown-toggle"  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                      </span>
                                      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="#"><i class="fas fa-pencil-alt"></i> Editar</a>
                                        <a class="dropdown-item" href="#"><i class="fas fa-share"></i> Compartir</a>
                                        <a class="dropdown-item" href="#"><i class="fas fa-cog"></i> Ajustes</a>
                                        <a class="dropdown-item" href="#"><i class="fas fa-power-off"></i> Apagar</a>
                                      </div>
                              </div>
                              <div class="nav-item">
                                      <h6 class="text-center">Last value Pressure:</h6>
                                      <div class="pressure value-dato" id="pressure">
                                          0.0
                                      </div>
                              </div>
                      </div>
                      
                </div>
              
            </div>
          </nav>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.sync@0.2.4/L.Map.Sync.min.js"></script>
    <script src="./Gauge/js/cmGauge.js"></script>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <script type="text/javascript">
        function createMap(id, center, server='https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}')
        {
            var map = L.map(id, { zoomControl:false }).setView(center, 6);
            var map_tiles_source = server;
            var map_max_zoom = 4;

            L.tileLayer(map_tiles_source, {
                maxZoom: map_max_zoom,
                attribution: '',
                id: 'mapbox.light'
            }).addTo(map);
            map.attributionControl.addAttribution('Space AG');

            return map;
        }
        $(document).ready(function()
        {
            var map= createMap('map', [0, 0], 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');

            var randomNum = Math.floor((Math.random()*100));
            $('#speed .gauge-arrow').cmGauge();

        
        });
        
       
        /*Speed-level*/

        /*API ubidots
        var ubidots = require('ubidots');
        var user = ubidots.createClient('BBFF-551f4a4642f4adc92d2a8865fa6d737f9e8');

        Client.auth(function(){
          this.getDatasources(function(err, data){
            console.log(data.results);
          });

          var 
        })*/

        window.onload = function () {

        var dataPoints1 = [];
        var dataPoints2 = [];
        var dataPoints3 = [];

        var chart = new CanvasJS.Chart("chartContainer", {
          zoomEnabled: true,
          
          axisY:{
            includeZero: false
          }, 
          toolTip: {
            shared: true
          },
          legend: {
            cursor:"pointer",
            verticalAlign: "top",
            fontSize: 14,
            fontColor: "#717171",
            itemclick : toggleDataSeries
          },
          data: [
            { 
              type: "line",
              xValueType: "dateTime",
              yValueFormatString: "###.00",
              xValueFormatString: "hh:mm:ss TT",
              showInLegend: true,
              name: "Temperature",
              dataPoints: dataPoints1,
              color: "#717171",
            },
            {				
              type: "line",
              xValueType: "dateTime",
              yValueFormatString: "###.00",
              showInLegend: true,
              name: "Humidity" ,
              dataPoints: dataPoints2,
              color:"#036920"
            },
            {
              type: "line",
              xValueType: "dateTime",
              yValueFormatString: "###.00",
              showInLegend: true,
              name: "Light" ,
              dataPoints: dataPoints3,
              color:"#69af22"
            }]
        });

        function toggleDataSeries(e) {
          if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
            e.dataSeries.visible = false;
          }
          else {
            e.dataSeries.visible = true;
          }
          chart.render();
        }

        var updateInterval = 3000;
        var yValue1 = 600; 
        var yValue2 = 605;
        var yValue3 = 610;

        var time = new Date;

        function updateChart(count) {
          count = count || 1;
          var deltaY1, deltaY2, deltaY3;
          for (var i = 0; i < count; i++) {
            time.setTime(time.getTime()+ updateInterval);
            deltaY1 = .5 + Math.random() *(-.5-.5);
            deltaY2 = .5 + Math.random() *(-.5-.5);
            deltaY3 = .5 + Math.random() *(-.5-.5);

          yValue1 = Math.round((yValue1 + deltaY1)*100)/100;
          yValue2 = Math.round((yValue2 + deltaY2)*100)/100;
          yValue3 = Math.round((yValue3 + deltaY3)*100)/100;

          dataPoints1.push({
            x: time.getTime(),
            y: yValue1
          });
          dataPoints2.push({
            x: time.getTime(),
            y: yValue2
          });
          dataPoints3.push({
            x: time.getTime(),
            y: yValue3
          });
          }

          chart.options.data[0].legendText = "Temperature";
          chart.options.data[1].legendText = "Humidity "; 
          chart.options.data[2].legendText = "Light(lux)";
          chart.render();
        }

        updateChart(100);	
        setInterval(function(){updateChart()}, updateInterval);

        }
    </script>
</body>
</html>